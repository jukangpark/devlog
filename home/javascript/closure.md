---
description: 클로저란 무엇인가
---

# Closure

### 클로저란?

함수와 함수가 선언된 어휘적 환경의 조합이다.\
클로저란 자신이 생성될 때의 '환경'을 기억하는 '함수'다.\
클로저란 자신이 생성될 때의 스코프에서 알 수 있었던 변수를 기억하는 '함수'이다.\
정의만 봐서는 정확히 이해하기 힘들다.\
우리는 클로저를 이해하기 위해\
JavaScript 가 어떻게 변수의 유효 범위를 지정하는지(Lexical scoping) 를 먼저 이해해야 한다.



### 렉시컬 스코핑(Lexical Scoping) 이란?

함수를 '호출' 할 때가 아니라, 함수를 어디에 '선언' 하는지에 따라 결정된다. \
이를 렉시컬 스코핑이라 한다.

```javascript
  const num = 5;

  const outerFunc = () => {
    const num = 10;
    const innerFunc = () => {
      console.log("num는", num); // 5 일까요? 10일까요?
    };
    return innerFunc;
  };

  const inner = outerFunc();

  inner();
```

이미 life-cycle이 종료되어 실행 컨텍스트 스택에서 제거된 함수 outerFunc의 지역변수 num이 다시 부활이라도 한 듯이 동작하고 있다. \
뭔가 특별한 일이 일어나고 있는 것 같다. \
이처럼 자신을 포함하고 있는 외부함수보다 내부함수가 더 오래 유지되는 경우, \
외부 함수 밖에서 내부함수가 호출되더라도 \
외부함수의 지역 변수에 접근할 수 있는데 이러한 함수를 클로저(Closure)라고 부른다. \
즉, 클로저는 반환된 내부함수가 자신이 선언됐을 때의 환경(Lexical environment)인 스코프를 기억하여 \
자신이 선언됐을 때의 환경(스코프) 밖에서 호출되어도 \
그 환경(스코프)에 접근할 수 있는 함수를 말한다. \
이를 조금 더 간단히 말하면 클로저는 \
자신이 생성될 때의 환경(Lexical environment)을 기억하는 함수다라고 말할 수 있겠다.



클로저에 의해 참조되는 외부함수의 변수 즉 outerFunc 함수의 변수 num을 자유변수(Free variable)라고 부른다. \
클로저라는 이름은 자유변수에 함수가 닫혀있다(closed)라는 의미로 의역하면 자유변수에 엮여있는 함수라는 뜻이다. 실행 컨텍스트의 관점에 설명하면, \
내부함수가 유효한 상태에서 외부함수가 종료하여 외부함수의 실행 컨텍스트가 반환되어도, \
외부함수 실행 컨텍스트 내의 활성 객체(Activation object)(변수, 함수 선언 등의 정보를 가지고 있다)는 \
내부함수에 의해 참조되는 한 유효하여 내부함수가 스코프 체인을 통해 참조할 수 있는 것을 의미한다. \
즉 외부함수가 이미 반환되었어도 외부함수 내의 변수는 이를 필요로 하는 내부함수가 하나 이상 존재하는 경우 \
계속 유지된다. \
이때 내부함수가 외부함수에 있는 변수의 복사본이 아니라 \
실제 변수에 접근한다는 것에 주의하여야 한다. \
클로저는 자신이 생성될 때의 환경(Lexical environment)을 기억해야 하므로 메모리 차원에서 손해를 볼 수 있다. \
하지만 클로저는 자바스크립트의 강력한 기능으로 이를 적극적으로 사용해야 한다.&#x20;

###

### 클로저를 사용해야 하는 이유?

변수의 값은 누군가에 의해 언제든지 변경될 수 있어 \
오류 발생의 근본적 원인이 될 수 있다. \
상태 변경이나 가변(mutable) 데이터를 피하고 불변성(Immutability)을 지향하는 함수형 프로그래밍에서 \
부수 효과(Side effect)를 최대한 억제하여, \
오류를 피하고 프로그램의 안정성을 높이기 위해 클로저는 적극적으로 사용해야한다.

```javascript

  const addMaker = (a) => {
    return function (b) {
      return a + b;
    };
  };

  console.log(addMaker(10)(5)); // 15
```

addMaker 에 인자 10을 넣고 호출하게 되면 \
익명함수를 리턴해주고, addMaker 의 함수는 종료된다.\
그럼에도 불구하고, addMaker 를 호출하게 되면 리턴되는 함수(클로저) 에서\
addMaker 에 인자로 넣어줬었던 10 을 참조할 수가 있다.\
왜냐하면 클로저(현재 이 코드상의 익명함수) 는 자신이 선언됐을 때의 \
환경을 기억하기 때문이다.



#### 결론

* 클로저란 자신이 생성될 때의 '환경'을 기억하는 '함수'다.
* 클로저란 자신이 생성될 때의 스코프에서 알 수 있었던 변수를 기억하는 '함수'이다.

###
